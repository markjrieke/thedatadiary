# setup ----
library(tidyverse)
library(urbnmapr)
devtools::source_url("https://raw.githubusercontent.com/markjrieke/thedatadiary/main/dd_theme_elements/dd_theme_elements.R")

# create NBC chart ----
tibble(
  date = as.Date(c("1995-12-01",
                   "1997-12-01",
                   "2002-01-01",
                   "2007-03-01",
                   "2007-09-01",
                   "2008-07-01",
                   "2008-09-01",
                   "2008-10-01",
                   "2009-02-01",
                   "2009-04-01",
                   "2009-09-01",
                   "2009-10-01",
                   "2009-12-01",
                   "2010-01-01",
                   "2010-06-01",
                   "2010-08-01",
                   "2010-10-01",
                   "2011-02-01",
                   "2011-06-01",
                   "2012-06-01",
                   "2013-06-01",
                   "2013-10-01",
                   "2014-06-01",
                   "2014-11-01",
                   "2015-07-01",
                   "2017-04-01",
                   "2018-01-01",
                   "2019-02-01",
                   "2020-05-01",
                   "2021-04-01")),
  statement_A = c(0.32,
                  0.41,
                  0.45,
                  0.52,
                  0.55,
                  0.53,
                  0.48,
                  0.47,
                  0.51,
                  0.47,
                  0.45,
                  0.46,
                  0.44,
                  0.43,
                  0.47,
                  0.47,
                  0.45,
                  0.51,
                  0.51,
                  0.49,
                  0.48,
                  0.52,
                  0.46,
                  0.52,
                  0.50,
                  0.57,
                  0.58,
                  0.55,
                  0.57,
                  0.55),
  statement_B = c(0.62,
                  0.51,
                  0.43,
                  0.40,
                  0.38,
                  0.42,
                  0.42,
                  0.45,
                  0.40,
                  0.46,
                  0.49,
                  0.48,
                  0.47,
                  0.48,
                  0.49,
                  0.47,
                  0.50,
                  0.46,
                  0.46,
                  0.47,
                  0.48,
                  0.44,
                  0.50,
                  0.46,
                  0.46,
                  0.39,
                  0.38,
                  0.41,
                  0.38,
                  0.41)
) %>%
  pivot_longer(cols = starts_with("statement"),
               values_to = "pct",
               names_to = "statement") %>%
  ggplot(aes(x = date,
             y = pct,
             color = statement,
             fill = statement)) +
  geom_smooth(se = TRUE,
              alpha = 0.1,
              span = 0.65) +
  geom_point(alpha = 0.6,
             size = 4) +
  dd_theme +
  theme(legend.position = "none") +
  labs(title = "Role of Government - Trend",
       subtitle = "<span style = 'color:#5565D7'>**Statement A:**</span> Government should do more to solve problems and help meet the needs of people.<br>
       <span style = 'color:#D75565'>**Statement B:**</span> Government is doing too many things better left to businesses and individuals.",
       caption = "NBC News Poll April 2021 Hart Research Slides<br>Created by @markjrieke",
       x = NULL,
       y = NULL) +
  scale_color_manual(values = c(dd_blue,
                                dd_red)) +
  scale_fill_manual(values = c(dd_blue,
                               dd_red)) +
  geom_vline(xintercept = as.Date("2001-01-01"),
             linetype = "dashed") +
  geom_vline(xintercept = as.Date("2009-01-01"),
             linetype = "dashed") +
  geom_vline(xintercept = as.Date("2017-01-01"),
             linetype = "dashed") +
  geom_vline(xintercept = as.Date("2021-01-01"),
             linetype = "dashed") +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  annotate(geom = "label",
           label = "Clinton",
           x = as.Date("1997-06-01"),
           y = 0.65,
           label.size = 0,
           fontface = "bold",
           family = "Siemens Slab",
           size = 6,
           fill = dd_orange,
           alpha = 0.25) +
  annotate(geom = "label",
           label = "Bush",
           x = as.Date("2005-01-01"),
           y = 0.65,
           label.size = 0,
           fontface = "bold",
           family = "Siemens Slab",
           size = 6,
           fill = dd_orange,
           alpha = 0.25) +
  annotate(geom = "label",
           label = "Obama",
           x = as.Date("2013-01-01"),
           y = 0.65,
           label.size = 0,
           fontface = "bold",
           family = "Siemens Slab",
           size = 6,
           fill = dd_orange,
           alpha = 0.25) +
  annotate(geom = "label",
           label = "Trump",
           x = as.Date("2019-01-01"),
           y = 0.65,
           label.size = 0,
           fontface = "bold",
           family = "Siemens Slab",
           size = 6,
           fill = dd_orange,
           alpha = 0.25)

ggsave("2021.05.03-misc_ish/p1.png",
       width = 9,
       height = 6,
       units = "in",
       dpi = 500)  

